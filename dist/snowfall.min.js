/*!
 * SnowFall2 v0.0.3
 * Copyright 2026 hi2ma-bu4
 * Licensed under the Apache License, Version 2.0
 * http://www.apache.org/licenses/LICENSE-2.0
 */
var O=Object.defineProperty;var T=(n,e)=>{for(var t in e)O(n,t,{get:e[t],enumerable:!0})};var v={};T(v,{allocate_memory:()=>D,default:()=>x,free_memory:()=>$,initSync:()=>P,lexer:()=>C,main_init:()=>N,version:()=>V});var i,c=null;function m(){return(c===null||c.buffer.detached===!0||c.buffer.detached===void 0&&c.buffer!==i.memory.buffer)&&(c=new DataView(i.memory.buffer)),c}function b(n,e){return n=n>>>0,z(n,e)}var _=null;function g(){return(_===null||_.byteLength===0)&&(_=new Uint8Array(i.memory.buffer)),_}function h(n,e,t){if(t===void 0){let a=w.encode(n),l=e(a.length,1)>>>0;return g().subarray(l,l+a.length).set(a),d=a.length,l}let r=n.length,s=e(r,1)>>>0,u=g(),o=0;for(;o<r;o++){let a=n.charCodeAt(o);if(a>127)break;u[s+o]=a}if(o!==r){o!==0&&(n=n.slice(o)),s=t(s,r,r=o+n.length*3,1)>>>0;let a=g().subarray(s+o,s+r),l=w.encodeInto(n,a);o+=l.written,s=t(s,r,o,1)>>>0}return d=o,s}function A(n){let e=i.__wbindgen_externrefs.get(n);return i.__externref_table_dealloc(n),e}var p=new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0});p.decode();var j=2146435072,y=0;function z(n,e){return y+=e,y>=j&&(p=new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0}),p.decode(),y=e),p.decode(g().subarray(n,n+e))}var w=new TextEncoder;"encodeInto"in w||(w.encodeInto=function(n,e){let t=w.encode(n);return e.set(t),{read:n.length,written:t.length}});var d=0;function D(n){return i.allocate_memory(n)>>>0}function $(n,e){i.free_memory(n,e)}function C(n){let e=h(n,i.__wbindgen_malloc,i.__wbindgen_realloc),t=d,r=i.lexer(e,t);if(r[2])throw A(r[1]);return A(r[0])}function N(){i.main_init()}function V(){let n,e;try{let t=i.version();return n=t[0],e=t[1],b(t[0],t[1])}finally{i.__wbindgen_free(n,e,1)}}var F=new Set(["basic","cors","default"]);async function B(n,e){if(typeof Response=="function"&&n instanceof Response){if(typeof WebAssembly.instantiateStreaming=="function")try{return await WebAssembly.instantiateStreaming(n,e)}catch(r){if(n.ok&&F.has(n.type)&&n.headers.get("Content-Type")!=="application/wasm")console.warn("`WebAssembly.instantiateStreaming` failed because your server does not serve Wasm with `application/wasm` MIME type. Falling back to `WebAssembly.instantiate` which is slower. Original error:\n",r);else throw r}let t=await n.arrayBuffer();return await WebAssembly.instantiate(t,e)}else{let t=await WebAssembly.instantiate(n,e);return t instanceof WebAssembly.Instance?{instance:t,module:n}:t}}function E(){let n={};return n.wbg={},n.wbg.__wbg_Error_52673b7de5a0ca89=function(e,t){return Error(b(e,t))},n.wbg.__wbg_String_8f0eb39a4a4c2f66=function(e,t){let r=String(t),s=h(r,i.__wbindgen_malloc,i.__wbindgen_realloc),u=d;m().setInt32(e+4,u,!0),m().setInt32(e+0,s,!0)},n.wbg.__wbg___wbindgen_throw_dd24417ed36fc46e=function(e,t){throw new Error(b(e,t))},n.wbg.__wbg_error_7534b8e9a36f1ab4=function(e,t){let r,s;try{r=e,s=t,console.error(b(e,t))}finally{i.__wbindgen_free(r,s,1)}},n.wbg.__wbg_new_1ba21ce319a06297=function(){return new Object},n.wbg.__wbg_new_25f239778d6112b9=function(){return new Array},n.wbg.__wbg_new_8a6f238a6ece86ea=function(){return new Error},n.wbg.__wbg_set_3f1d0b984ed272ed=function(e,t,r){e[t]=r},n.wbg.__wbg_set_7df433eea03a5c14=function(e,t,r){e[t>>>0]=r},n.wbg.__wbg_stack_0ed75d68575b0f3c=function(e,t){let r=t.stack,s=h(r,i.__wbindgen_malloc,i.__wbindgen_realloc),u=d;m().setInt32(e+4,u,!0),m().setInt32(e+0,s,!0)},n.wbg.__wbindgen_cast_2241b6af4c4b2941=function(e,t){return b(e,t)},n.wbg.__wbindgen_cast_4625c577ab2ec9ee=function(e){return BigInt.asUintN(64,e)},n.wbg.__wbindgen_cast_9ae0607507abb057=function(e){return e},n.wbg.__wbindgen_cast_d6cd19b81560fd6e=function(e){return e},n.wbg.__wbindgen_init_externref_table=function(){let e=i.__wbindgen_externrefs,t=e.grow(4);e.set(0,void 0),e.set(t+0,void 0),e.set(t+1,null),e.set(t+2,!0),e.set(t+3,!1)},n}function k(n,e){return i=n.exports,I.__wbindgen_wasm_module=e,c=null,_=null,i.__wbindgen_start(),i}function P(n){if(i!==void 0)return i;typeof n<"u"&&(Object.getPrototypeOf(n)===Object.prototype?{module:n}=n:console.warn("using deprecated parameters for `initSync()`; pass a single object instead"));let e=E();n instanceof WebAssembly.Module||(n=new WebAssembly.Module(n));let t=new WebAssembly.Instance(n,e);return k(t,n)}async function I(n){if(i!==void 0)return i;typeof n<"u"&&(Object.getPrototypeOf(n)===Object.prototype?{module_or_path:n}=n:console.warn("using deprecated parameters for the initialization function; pass a single object instead")),typeof n>"u"&&(n=new URL("snowfall_core_bg.wasm",import.meta.url));let e=E();(typeof n=="string"||typeof Request=="function"&&n instanceof Request||typeof URL=="function"&&n instanceof URL)&&(n=fetch(n));let{instance:t,module:r}=await B(await n,e);return k(t,r)}var x=I;var f=class{static isDebug=!1;static prefix="SnowFall";static info(...e){this.isDebug&&console.log(`[${this.prefix}]`,...e)}static warn(...e){console.warn(`[${this.prefix}]`,...e)}static error(...e){console.error(`[${this.prefix}]`,...e)}};function S(n){let e=/^v?(\d+)\.(\d+)\.(\d+)$/.exec(n);return e?{major:Number(e[1]),minor:Number(e[2]),patch:Number(e[3])}:null}function W(n,e){return n.major!==e.major?{kind:"err",message:`MAJOR mismatch: ts=${n.major}, rust=${e.major}`}:n.minor!==e.minor?{kind:"err",message:`MINOR mismatch: ts=${n.minor}, rust=${e.minor}`}:n.patch!==e.patch?{kind:"warn",message:`PATCH mismatch: ts=${n.patch}, rust=${e.patch}`}:{kind:"ok"}}var M="v0.0.3";var R=class{_wasm=null;_isInitialized=!1;constructor(e=!1){f.isDebug=e}async init(e){if(!this._isInitialized){try{await x(e)}catch(t){throw f.error("Failed to initialize SnowFall Wasm module:",t),t}this._wasm=v,this._versionCheck(),this._isInitialized=!0,f.info("SnowFall Wasm module initialized successfully.")}}ensureInitialized(){if(!this._wasm||!this._isInitialized)throw new Error("SnowFall has not been initialized. Please call init() first.");return this._wasm}version(){return M}version_wasm(){return this.ensureInitialized().version()}dev_lexer(e){return this.ensureInitialized().lexer(e)}_versionCheck(){if(!this._wasm)return;let e=S(this.version()),t=S(this._wasm.version());if(!e||!t)throw new Error("Invalid version format (expected x.y.z)");let r=W(e,t);switch(r.kind){case"ok":return;case"warn":f.warn("[Version]",r.message);return;case"err":throw new Error(`[Version] ${r.message}`)}}};export{R as SnowFall};
//# sourceMappingURL=snowfall.min.js.map
